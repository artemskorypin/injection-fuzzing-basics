# Insecure Deserialization wordlists

Этот раздел — про **инъекции в механизмы десериализации** (PHP, Java, .NET и пр.).

Как и в остальном репозитории:

> **одна строка = один payload**, минимум дубликатов, фокус на **детекте и первичной разведке**, а не на готовых gadget-chain’ах и RCE.

За полноценной эксплуатацией (ysoserial, PHPGGC, ViewState RCE и т.п.) можно идти в разделы *Insecure Deserialization* репозитория PayloadsAllTheThings.

---

## Файлы

### `deser_php_basic.txt`

Мини-словари для **PHP `unserialize()`**:

- простые массивы и объекты (`a:1:{...}`, `O:8:"stdClass":{...}`),
- полезны для проверки:
  - принимает ли сервер PHP-serialize как вход;
  - появляются ли в ответе/логах ошибки вида `unserialize(): Error at offset ...`.

Применение:

- подставлять в параметры/куки/тело, которые выглядят как сериализованные строки (`a:1:{...}`, `O:...`);
- смотреть, меняется ли поведение / вылезают ли PHP-warning’и.

---

### `deser_java_magic.txt`

Payload’ы, которые выглядят как **Java-serialization в Base64**:

- строки, начинающиеся на `rO0AB...` — “магический” префикс Java-сериализации;
- могут вызывать ошибки Java-десериализации, если вход где-то уходит в `ObjectInputStream.readObject()`.

Применение:

- подставлять в подозрительные поля/куки (особенно Base64-похожие значения);
- по ошибкам в ответе/логах можно понять, что внутри есть Java-десериализация, даже без рабочего гаджета.

---

### `deser_net_viewstate_pattern.txt`

Короткие паттерны под **ASP.NET ViewState / EventValidation**:

- типичные префиксы Base64-ViewState (`/wEPDw...`);
- помогают проверить, есть ли на стороне сервера обработка похожих значений как ViewState.

Применение:

- использовать в полях `__VIEWSTATE`, `__EVENTVALIDATION` или там, где приложение может прокидывать значения в эти механизмы;
- если в ответе появляются ошибки вроде “Invalid viewstate” / “Validation of viewstate MAC failed” — это сигнал, что там крутится .NET-десериализация.

---

## Использование

- Все файлы рассчитаны на **обнаружение самого факта десериализации** и типа механизма (PHP / Java / .NET), а не на автоматический RCE.
- Типичный сценарий:
  1. Видишь странную сериализованную строку / Base64 в параметре или cookie.
  2. Подставляешь payload’ы из соответствующего файла.
  3. Анализируешь:
     - ошибки в ответе,
     - запись в логах,
     - изменения поведения приложения.

После подтверждения, что там реально используется десериализация нужного типа, за “боевыми” gadget-цепочками уже можно идти в специализированные инструменты и PayloadsAllTheThings.

