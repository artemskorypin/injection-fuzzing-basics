# XSS

Данный каталог содержит словари для обнаружения XSS-инъекций (reflected, stored и DOM-based) в различных контекстах. Основной акцент сделан на компактных, понятных полезных нагрузках, пригодных как для фаззинга в инструментах вроде OWASP ZAP, так и в качестве учебного материала.

Все словари строятся по принципу «одна строка — один payload» и ориентированы на детект уязвимости: в них отсутствуют заведомо разрушительные или явно эксплуатационные сценарии (кража cookie, keylogger’ы, сложные цепочки с обходом CSP и т.п.).

## Структура каталога

### 1. Stored / Reflected XSS

Подкаталоги с наборами полезных нагрузок для отражённых и хранимых XSS, сгруппированных по контекстам, в которые попадает пользовательский ввод, например:

- HTML-теги и атрибуты;
- CSS и style-атрибуты;
- URI/URL (схемы, параметры ссылок);
- XML/SVG;
- Markdown и похожие разметки.

Такая разбивка позволяет подбирать payload’ы в зависимости от того, где именно в ответе приложения оказывается исследуемая строка (в тексте, в атрибуте, в JavaScript-коде и т.д.).

### 2. DOM-based XSS

Словари для DOM-ориентированных XSS, когда пользовательский ввод обрабатывается на стороне клиента (в JavaScript) и может быть выполнен через небезопасные операции:

- **XSS-JSB.txt** — полезные нагрузки для инъекций в JavaScript-код (например, при передаче данных в `eval`, конструктор `Function`, динамическое формирование фрагментов DOM и т.п.);
- **XSS-JSN.txt** — payload’ы для случаев, когда данные попадают в JSON-структуры, а затем используются в логике приложения.

Цель этих словарей — показать сам факт выполнения кода из пользовательских данных без перехода к сложным эксплуатациям.

### 3. Polyglot XSS

- **XSS-POLYGLOTS.txt**  

Компактный набор XSS-полиглотов, рассчитанных на срабатывание в нескольких контекстах одновременно (HTML, атрибуты, скрипты, URI и др.).  
Файл объединяет:

- базовые полиглотные полезные нагрузки, разработанные в рамках проекта;
- популярный «классический» полиглот (ранее находившийся в отдельном файле), включённый сюда для удобства.

Рекомендуется использовать этот словарь для первоначенного детектирования XSS в случаях, когда контекст внедрения не до конца понятен.

### 4. XSS special

- **Каталог `XSS_special`** содержит дополнительные словари для расширенного фаззинга и обхода фильтров (например, `XSS-Fuzzing.txt` и `XSS-NO-PARENS.txt`).  
  Они могут создавать больше «шума» и нагрузки и поэтому обычно применяются после базовых словарей, когда требуется углублённая проверка или исследование поведения фильтров/WAF.

## Принципы построения словарей

При формировании словарей XSS придерживались следующих принципов:

- каждая запись в словаре отражает **отдельную идею или технику** (контекст, обход фильтра, особенность синтаксиса);
- по возможности исключались точные дубликаты и бессмысленные вариации одной и той же нагрузки;
- payload’ы ориентированы на **подтверждение наличия XSS** (например, через `alert(1)` или аналогичные безобидные эффекты);
- словари предназначены для использования в учебных стендах и в рамках разрешённого тестирования безопасности.

Рекомендуемый порядок использования:

1. Начать с контекстных словарей Stored/Reflected XSS и DOM-based XSS.
2. Подключить `XSS-POLYGLOTS.txt` для более универсального детекта в сложных или непонятных контекстах.
3. При необходимости расширить проверку за счёт дополнительных словарей из каталога `XSS_special`.
